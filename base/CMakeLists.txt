PROJECT(NCS_BASE)

FIND_PACKAGE(MPI)

SET(CMAKE_LIBRARY_OUTPUT_DIRECTORY "${CMAKE_CURRENT_BINARY_DIR}/lib")
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${CXX11_FLAGS}")

INCLUDE_DIRECTORIES("include" ${MPI_INCLUDE_PATH})

AUX_SOURCE_DIRECTORY("source/spec" specSource)
ADD_LIBRARY(ncs_spec SHARED ${specSource})
SET_TARGET_PROPERTIES(ncs_spec PROPERTIES LINKER_LANGUAGE CXX)

AUX_SOURCE_DIRECTORY("source/sim" simSource)
ADD_LIBRARY(ncs_sim SHARED ${simSource})
SET_TARGET_PROPERTIES(ncs_sim PROPERTIES LINKER_LANGUAGE CXX)

INSTALL(DIRECTORY include/ncs
        DESTINATION include
		FILES_MATCHING PATTERN "*.h")

IF(UNIX)
	TARGET_LINK_LIBRARIES(ncs_spec pthread dl)
	TARGET_LINK_LIBRARIES(ncs_sim pthread dl ${MPI_LIBRARIES})
	INSTALL(TARGETS ncs_spec ncs_sim LIBRARY DESTINATION lib)
ENDIF(UNIX)
